<VirtualHost *:80>
        
	ServerName cms.cloud-hub.co
	ProxyRequests Off
	ProxyPreserveHost  Off
	RewriteEngine on
	RewriteRule ^/site/(.*)$ /$1 [P] 

	<Location />
		Order deny,allow
		Allow from all
	</Location>

	
	#ProxyPassreverseCookieDomain http://hippo1:8080/cms cms.cloud-hub.co
	Header add Set-Cookie "ROUTEID=.%{BALANCER_WORKER_ROUTE}e; path=/" env=BALANCER_ROUTE_CHANGED
	<Proxy balancer://cluster>
		BalancerMember http://hippo1:8080 route=1
	    BalancerMember http://hippo2:8080 route=2
	    BalancerMember http://hippo3:8080 route=3
	    ProxySet stickysession=ROUTEID nofailover=Off	    
	</Proxy>
	ProxyPass /site/ balancer://cluster/site/
    ProxyPass / balancer://cluster/cms/
    ProxyPassReverse / balancer://cluster/cms/
    ProxyPassReverseCookiePath /cms /	

</VirtualHost>
<VirtualHost *:80>
            
	ServerName site.cloud-hub.co
	# everthing that does not match cms.example.com also goes to the site application
	ServerAlias *.cloud-hub.co

	ProxyRequests Off

		
	ProxyPreserveHost  On
	RewriteEngine on
	RewriteRule ^/site/(.*)$ /$1 [P] 

	<Location />
		Order deny,allow
		Allow from all
	</Location>
    
    Header add Set-Cookie "ROUTEID=.%{BALANCER_WORKER_ROUTE}e; path=/" env=BALANCER_ROUTE_CHANGED
	<Proxy balancer://cluster>
	    BalancerMember http://hippo1:8080 route=1
	    BalancerMember http://hippo2:8080 route=2
	    BalancerMember http://hippo3:8080 route=3
	    ProxySet stickysession=ROUTEID nofailover=Off
	</Proxy>
	ProxyPass / balancer://cluster/site/	
	ProxyPassReverse  / balancer://cluster/site/
    ProxyPassReverseCookiePath /site /
    #ProxyPassreverseCookieDomain balancer://cluster site.cloud-hub.co
</VirtualHost>
